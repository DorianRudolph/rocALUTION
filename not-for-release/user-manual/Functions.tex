\chapter{Functionality Table}

\section{Backend Support}

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{Backend name} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline
% Format           |  Host            |  CUDA  |  OpenCL  |  Xeon Phi
Status              & Stable         & Stable     & Stable             & \multicolumn{1}{l|}{Beta}\\ \hline
Target              & Intel/AMD CPU  & NVIDIA GPU & NVIDIA/AMD GPU     & \multicolumn{1}{l|}{MIC/Xeon Phi}\\ \hline
Parallelism         & OpenMP         & CUDA       & OpenCL             & \multicolumn{1}{l|}{OpenMP (offload mode)}\\ \hline
Required Lib        & None         & CUBLAS, CUSPARSE\footnotemark[1]  & None             & \multicolumn{1}{l|}{None}\\ \hline
Optional Lib              & Intel MKL         & None     & None             & \multicolumn{1}{l|}{None}\\ \hline
Compiler            & icc, gcc, VS     & nvcc     & NVIDIA/AMD ocl            & \multicolumn{1}{l|}{icc}\\ \hline
OS                  & Linux,Mac, Windows     & Linux,Mac, Windows     & Linux,Mac, Windows       & \multicolumn{1}{l|}{Linux}\\ \hline
\end{tabular}
\end{table}

\footnotetext[1]{CUBLAS and CUSPARSE are delivered with the CUDA package}

\section{Matrix-Vector Multiplication Formats}

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline
% Format           |  Host  |  CUDA  |  OpenCL  |  Xeon Phi
CSR                & Yes    & Yes    & Yes      & \multicolumn{1}{l|}{Yes}\\ \hline
COO                & Yes\footnotemark[2]    & Yes    & Yes      & \multicolumn{1}{l|}{Yes\footnotemark[2]}\\ \hline
ELL                & Yes    & Yes    & Yes      & \multicolumn{1}{l|}{Yes}\\ \hline
DIA                & Yes    & Yes    & Yes      & \multicolumn{1}{l|}{Yes}\\ \hline
HYB                & Yes    & Yes    & Yes      & \multicolumn{1}{l|}{Yes}\\ \hline
DENSE              & Yes    & Yes    & Yes\footnotemark[3]      & \multicolumn{1}{l|}{No}\\ \hline
BCSR               & No     & No     & No       & \multicolumn{1}{l|}{No}\\ \hline
\end{tabular}
\end{table}

\footnotetext[2]{Serial version}
\footnotetext[3]{Basic version}


All matrix conversions are performed via the CSR format (either as a source or a destitution -- e.g. the user cannot directly convert a DIA matrix to an ELL matrix). The conversions can be computed on the host or on the CUDA backend (except back conversions (to a CSR matrix), DENSE, BCSR and MCSR conversions). All other backends can perform the conversions via the host.


\begin{table}[h]
\begin{tabular}{l|c|c|c|c|}
\multicolumn{1}{c|}{} & \multicolumn{1}{l|}{Host} & \multicolumn{1}{l|}{CUDA} & \multicolumn{1}{l|}{OpenCL} & \multicolumn{1}{l|}{MIC/Xeon Phi} \\ \hline
B                     & Yes                                & No                        & No                          & No                                     \\ \hline
S                     & Yes                                & Yes                       & Yes                         & No                                     \\ \hline
M                     & Yes                                & Yes                       & Yes                         & No                                     \\ \hline
\end{tabular}
\caption{Complex support}
\end{table}

The base version supports only complex computation on the host.

\section{Local Matrices and Vectors}

All matrix operations (except the sparse matrix-vector multiplication SpMV) require a CSR matrix. Note that if the input matrix is not a CSR matrix, an internal conversion will be performed to the CSR format followed by a back conversion to the current matrix format after the operation. In this case, a warning message on level 2 will be printed.

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline
% function              |  Host    |  CUDA    |  OpenCL  |  Xeon Phi
\textbf{Local Matrices} &          &          &          & \\ \hline
I/O file                & Yes      & via Host & via Host & \multicolumn{1}{l|}{via Host} \\ \hline
Direct memory access    & Yes      & Yes      & Yes      & \multicolumn{1}{l|}{Yes}      \\ \hline
Extract sub matrix      & Yes      & Yes      & Yes      & \multicolumn{1}{l|}{via Host} \\ \hline
Extract diagonal        & Yes      & Yes      & Yes      & \multicolumn{1}{l|}{via Host} \\ \hline
Extract inv diagonal    & Yes      & Yes      & Yes      & \multicolumn{1}{l|}{via Host} \\ \hline
Permutation             & Yes      & Yes      & via Host & \multicolumn{1}{l|}{via Host} \\ \hline
Graph Analyzer          & Yes      & via Host & via Host & \multicolumn{1}{l|}{via Host} \\ \hline
Transpose               & Yes      & Yes      & via Host & \multicolumn{1}{l|}{via Host} \\ \hline
Sparse Mat-Mat Mult     & Yes      & Yes      & via Host & \multicolumn{1}{l|}{via Host} \\ \hline
\textbf{Local Vectors}  &          &          &          & \\ \hline
I/O file              & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline
Direct memory access         & Yes    & Yes   & Yes      & \multicolumn{1}{l|}{Yes} \\ \hline
Vector updates          & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Dot product             & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Dot product (conj/complex) & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{No} \\ \hline
Sub copy                & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Point-wise mult         & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Scaling                 & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Permutation             & Yes    & Yes     & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

\end{tabular}
\end{table}

\section{Global Matrices and Vectors}

All Local functions (for Vectors or Matrices) can be applied on the interior of each Global Matrix.

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline
% function                   |  Host  |  CUDA  |  OpenCL  |  Xeon Phi
\textbf{Global Matrices}      &        &       &         & \\ \hline
I/O file              & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline
Direct memory access         & Yes    & Yes   & Yes      & \multicolumn{1}{l|}{Yes} \\ \hline
\textbf{Global Vectors}  &        &       &         & \\ \hline
I/O file              & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline
Direct memory access         & Yes    & Yes   & Yes      & \multicolumn{1}{l|}{Yes} \\ \hline
Vector updates          & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Dot product             & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Dot product (conj/complex) & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{No} \\ \hline
Point-wise mult         & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
Scaling                 & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

\end{tabular}
\end{table}

\textbf{\emph{Note}} The OpenCL backend supports only GPUs in the multi-node version.

\section{Local Solvers and Preconditioners}

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline
% function           |  Host  |  CUDA  |  OpenCL  |  Xeon Phi
\textbf{Local Solvers} &  &       &          & \\ \hline
CG -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
CG -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

FCG -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
FCG -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

CR -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
CR -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

BiCGStab -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
BiCGStab -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

BiCGStab(l) -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
BiCGStab(l) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

QMRCGStab -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
QMRCGStab -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

GMRES -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
GMRES -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

FGMRES -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
FGMRES -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Chebyshev -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
Chebyshev -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Mixed-Precision DC -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
Mixed-Precision DC -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Fixed-Point Iteration -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
Fixed-Point Iteration -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

AMG(Plain Aggregation) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
AMG(Plain Aggregation) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

AMG(Smoothed Aggregation) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
AMG(Smoothed Aggregation) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

AMG(RS) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
AMG(RS) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

AMG(Pair-wise) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
AMG(Pair-wise) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

\textbf{Local Direct Solvers (DENSE only)} &  &       &          & \\ \hline
LU -- Building   & Yes    & via Host    & via Host     & \multicolumn{1}{l|}{via Host} \\
LU -- Solving    & Yes    & via Host    & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

QR -- Building   & Yes    & via Host    & via Host     & \multicolumn{1}{l|}{via Host} \\
QR -- Solving    & Yes    & via Host    & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

Inversion -- Building   & Yes    & via Host    & via Host     & \multicolumn{1}{l|}{via Host} \\
Inversion -- Solving    & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

\end{tabular}
\end{table}

\textbf{\emph{Note}} The building phase of the iterative solver depends also on the selected preconditioner.

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline

\textbf{Local Preconditioners} &  &       &          & \\ \hline
Jacobi -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
Jacobi -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

MC-ILU($0$,$1$) -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
MC-ILU($0$,$1$) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline
MC-ILU($>0$,$>1$) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
MC-ILU($>0$,$>1$) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

ME-(I)LU -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
ME-(I)LU -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

ILU($0$) -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
ILU($0$) -- Solving    & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline
ILU($>0$) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
ILU($>0$) -- Solving    & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

ILUT -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
ILUT -- Solving    & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

IC($0$) -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
IC($0$) -- Solving    & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

FSAI -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
FSAI -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

SPAI -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{via Host} \\
SPAI -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Chebyshev -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
Chebyshev -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

MC-GS/SGS -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
MC-GS/SGS -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

GS/SGS -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
GS/SGS -- Solving    & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\ \hline

AS/RAS -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{via Host} \\
AS/RAS -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Block -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{via Host} \\
Block -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

SaddlePoint -- Building   & Yes    & Yes   & via Host     & \multicolumn{1}{l|}{via Host} \\
SaddlePoint -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline


\end{tabular}
\end{table}


\section{Global Solvers and Preconditioners}

\begin{table}[H]
\begin{tabular}{l|l|l|l|l}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}Host\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}CUDA\end{tabular}} & \multicolumn{1}{c|}{\begin{tabular}[c]{@{}c@{}}OpenCL\end{tabular}} & \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}MIC/Xeon Phi\end{tabular}} \\ \hline
% function           |  Host  |  CUDA  |  OpenCL  |  Xeon Phi
\textbf{Global Solvers} &  &       &          & \\ \hline
CG -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
CG -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

FCG -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
FCG -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

CR -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
CR -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

BiCGStab -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
BiCGStab -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

BiCGStab(l) -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
BiCGStab(l) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

QMRCGStab -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
QMRCGStab -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

GMRES -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
GMRES -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

FGMRES -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
FGMRES -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Mixed-Precision DC -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
Mixed-Precision DC -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

Fixed-Point Iteration -- Building   & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\
Fixed-Point Iteration -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{Yes} \\ \hline

AMG(Pair-wise) -- Building   & Yes    & via Host   & via Host     & \multicolumn{1}{l|}{No} \\
AMG(Pair-wise) -- Solving    & Yes    & Yes   & Yes     & \multicolumn{1}{l|}{No} \\ \hline

\end{tabular}
\end{table}

\textbf{\emph{Note}} The building phase of the iterative solver depends also on the selected preconditioner. \\

All local preconditioner can be used on a Global level by Block-Jacobi type of preconditioner, where the local preconditioner will be applied on each node/process interior matrix.
